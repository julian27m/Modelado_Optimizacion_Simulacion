'''
*************************************************************************
***      Lab 4 - Ejercicio 3                                          ***
***                                                                   ***
***      Autores: JuliÃ¡n Mora - Luisa Fuentes                         ***
*************************************************************************
'''

from pyomo.environ import *
from pyomo.opt import SolverFactory

import sys
import os

#os.system("clear")
#sys.exit("Stopped")


# Model
model = ConcreteModel()

#SETS AND PARAMETERS**********************************************************
model.N={'1-1', '1-2', '1-3', '1-4', '2-1', '2-2', '2-3', '2-4', '3-1', '3-2', '3-3', '3-4', '4-1', '4-2', '4-3', '4-4', '5-1', '5-2', '5-3', '5-4'}
model.M={'A','B','C','D','E','F','L'}

c = {
    ('1-1','A'): 1, ('1-1','B'): 0, ('1-1','C'): 0, ('1-1','D'): 0, ('1-1','E'): 0, ('1-1','F'): 0, ('1-1','L'): 0,
    ('1-2','A'): 0, ('1-2','B'): 0, ('1-2','C'): 1, ('1-2','D'): 0, ('1-2','E'): 0, ('1-2','F'): 0, ('1-2','L'): 0,
    ('1-3','A'): 0, ('1-3','B'): 0, ('1-3','C'): 1, ('1-3','D'): 0, ('1-3','E'): 0, ('1-3','F'): 0, ('1-3','L'): 0,
    ('1-4','A'): 0, ('1-4','B'): 0, ('1-4','C'): 0, ('1-4','D'): 0, ('1-4','E'): 0, ('1-4','F'): 0, ('1-4','L'): 0,
    ('2-1','A'): 1, ('2-1','B'): 1, ('2-1','C'): 0, ('2-1','D'): 0, ('2-1','E'): 0, ('2-1','F'): 0, ('2-1','L'): 0,
    ('2-2','A'): 0, ('2-2','B'): 0, ('2-2','C'): 1, ('2-2','D'): 0, ('2-2','E'): 0, ('2-2','F'): 0, ('2-2','L'): 0,
    ('2-3','A'): 0, ('2-3','B'): 0, ('2-3','C'): 1, ('2-3','D'): 0, ('2-3','E'): 0, ('2-3','F'): 0, ('2-3','L'): 0,
    ('2-4','A'): 0, ('2-4','B'): 0, ('2-4','C'): 0, ('2-4','D'): 0, ('2-4','E'): 0, ('2-4','F'): 0, ('2-4','L'): 1,
    ('3-1','A'): 0, ('3-1','B'): 1, ('3-1','C'): 0, ('3-1','D'): 1, ('3-1','E'): 0, ('3-1','F'): 0, ('3-1','L'): 0,
    ('3-2','A'): 0, ('3-2','B'): 0, ('3-2','C'): 0, ('3-2','D'): 1, ('3-2','E'): 1, ('3-2','F'): 0, ('3-2','L'): 0,
    ('3-3','A'): 0, ('3-3','B'): 0, ('3-3','C'): 0, ('3-3','D'): 0, ('3-3','E'): 1, ('3-3','F'): 0, ('3-3','L'): 0,
    ('3-4','A'): 0, ('3-4','B'): 0, ('3-4','C'): 0, ('3-4','D'): 0, ('3-4','E'): 0, ('3-4','F'): 0, ('3-4','L'): 1,
    ('4-1','A'): 0, ('4-1','B'): 0, ('4-1','C'): 0, ('4-1','D'): 1, ('4-1','E'): 0, ('4-1','F'): 1, ('4-1','L'): 0,
    ('4-2','A'): 0, ('4-2','B'): 0, ('4-2','C'): 0, ('4-2','D'): 1, ('4-2','E'): 1, ('4-2','F'): 0, ('4-2','L'): 0,
    ('4-3','A'): 0, ('4-3','B'): 0, ('4-3','C'): 0, ('4-3','D'): 0, ('4-3','E'): 1, ('4-3','F'): 0, ('4-3','L'): 0,
    ('4-4','A'): 0, ('4-4','B'): 0, ('4-4','C'): 0, ('4-4','D'): 0, ('4-4','E'): 0, ('4-4','F'): 0, ('4-4','L'): 1,
    ('5-1','A'): 0, ('5-1','B'): 0, ('5-1','C'): 0, ('5-1','D'): 0, ('5-1','E'): 0, ('5-1','F'): 1, ('5-1','L'): 0,
    ('5-2','A'): 0, ('5-2','B'): 0, ('5-2','C'): 0, ('5-2','D'): 0, ('5-2','E'): 0, ('5-2','F'): 0, ('5-2','L'): 0,
    ('5-3','A'): 0, ('5-3','B'): 0, ('5-3','C'): 0, ('5-3','D'): 0, ('5-3','E'): 0, ('5-3','F'): 0, ('5-3','L'): 1,
    ('5-4','A'): 0, ('5-4','B'): 0, ('5-4','C'): 0, ('5-4','D'): 0, ('5-4','E'): 0, ('5-4','F'): 0, ('5-4','L'): 1,
}

#VARIABLES*********************************************************************
model.x = Var(model.N, domain=Binary)

#OBJECTIVE FUNCTION************************************************************
model.z = Objective(expr=sum(model.x[i] for i in model.N), sense=minimize)

# CONSTRAINTS******************************************************************
def todas_cubiertas_sin_repetir_tuberia_rule(model, j):
    return sum(model.x[i] * c[i, j] for i in model.N) >= 1

model.todas_cubiertas_sin_repetir_tuberia = Constraint(model.M, rule=todas_cubiertas_sin_repetir_tuberia_rule)

#APPLYING THE SOLVER************************************************************
SolverFactory('glpk').solve(model)
model.display()

